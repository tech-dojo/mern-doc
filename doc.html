<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Bare - Start Bootstrap Template</title>

  <!-- Bootstrap Core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="css/doc.css" rel="stylesheet">

  <!-- Custom CSS -->
  <style>
    body {
      padding-top: 70px;
      /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
    }
  </style>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>

  <!-- Navigation -->
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="./index.html"><img className="brand_logo" src="./images/mern.png"/>  <span>A React framework</span></a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav pull-right">
          <li>
              <a href="./doc.html"><i class="fa fa-github-square menuIcon"></i></a>
          </li>
          <li>
            <a href="./doc.html"><i class="fa fa-twitter-square menuIcon"></i></a>
          </li>

        </ul>

      </div>
      <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
  </nav>

  <!-- Page Content -->
  <div class="container marginBottom">
    <div class="row">
      <div class="col-lg-3 col-md-4 col-sm-5 col-xs-12">
        <nav>
          <ul class="nav nav-pills nav-stacked menuCss">
            <li>
              <a href="#gettingStarted">Getting Started</a>
            </li>
            <li>
              <a href="#folderStructure">Folder Structure</a>
            </li>
            <li>
              <a href="#utf">Understanding the Framework</a>
              <ul class="subSection">
                <ul>
                  <a href="#clientSideArticle">Client Side (Article)</a>
                </ul>
                <ul>
                  <a href="#serverSideArticle">Server Side (Article)</a>
              </ul>
              <ul>
                <a href="#clientSideSignUp">Client Side (Sign Up)</a>
              </ul>
              <ul>
                <a href="#serverSideSignUp">Server Side (Sign Up)</a>
            </ul>
              </ul>
            </li>
            <li>
              <a href="#isomorphic">Isomorphic</a>
            </li>
            <li>
              <a href="#testCode">Test Code</a>
            </li>
          </ul>
        </nav>

      </div>

      <span id="gettingStarted"></span>
      <div class="col-lg-9 col-md-8 col-sm-7 col-xs-12">
        <div>
          <h1>Getting Started</h1>
          <hr>
          <p>
            The React Framework is designed to be as natural as possible for a web developer to build a great web
            application, focusing on using the standard HTML, CSS, and Javascript.
          </p>
          <h2>Prerequisites</h2>
        <p>To start working with the React Framework, the following prerequisites should be installed.</p>
          <h4><b>Node.js & npm Install</b></h4>

          <div>
            <ul class="shellCommands">
              <li> $ sudo apt-get install curl </li>
              <li>$ curl -sL https://deb.nodesource.com/setup | sudo bash - </li>
              <li>$ sudo apt-get install -y nodejs </li>
              <li>$ sudo apt-get install -y build-essential (Recommended for Linux) </li>
              <li>$ npm install -g gulp </li>
              <li>$ npm install --save gulp</li>
            </ul>
          </div>

          <h4><b>MongoDB Install</b></h4>
          <div>
            <ul class="shellCommands">
              <li>$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10</li>
              <li>$ echo "deb http://repo.mongodb.org/apt/ubuntu</li>
              <li>$(lsb_release -sc)"/mongodb-org/3.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.0.list</li>
              <li>$ sudo apt-get update</li>
              <li>$ sudo apt-get install -y mongodb-org</li>
            </ul>
          </div>
          <h4><b>Git Install/Clone</b></h4>

          <div>
            <ul class="shellCommands">
              <li>$ apt-get update</li>
              <li>$ apt-get install git</li>
              <li>$ git clone https://github.com/<i>(Clone ReactFramework)</i></li>
            </ul>
          </div>

          <h4><b>After cloning the project from github to run the app</b></h4>

          <div>

              <p><span class="l-sub-section">Make sure <b>mongodb</b> is running, to run <b>mongodb</b>,</span></p>
            <ul class="shellCommands">
              <li>$ mongod</li>
            </ul>
              <p><span class="l-sub-section">Install global dependencies with,</span></p>
            <ul class="shellCommands" >
              <li>$ npm install -g gulp bower react-tools browserify</li>
            </ul>
              <p><span class="l-sub-section">Install dependencies with,</span></p>
            <ul class="shellCommands">
              <li>$ npm install</li>
            </ul>
              <p><span class="l-sub-section">Run app with,</span></p>
            <ul class="shellCommands">
              <li id="folderStructure">$ gulp serve</li>
            </ul>
          </div >
        </div>
<div>
<h1>Folder Structure</h1>
<hr>
<p>The basic structure for this project is quite simple:</p>
<p class="shellCommands">
|-.tmp
|-app

|------Components

|------------articles
|------------core
|------------users
|------------App.jsx

|------images
|------services

|------------Authentication.js

|------stores
|------------ArticleStore.jsx
|------------RestAPI_Helper.js
|------------UserStore.jsx

|-server
|------controllers
|------models
|------routes
|------strategies
|------express.js
|------passport.js
|------seeds.js
|------server.js

|-.gitignore
|-gulpfile.js
|-package.json

</p>

<h2>App</h2>

<p>Front-end folders and files are stored here.</p>

<h4><span class="folderName-title">Components</span></h4>

<p>The components folder contain React JS application components, to learn more about it visit the <a target="blank" href="https://facebook.github.io/react/docs/component-api.html">React JS components section</a>.</p>

  <h4><span class="folderName-title">Services</span></h4>
      <p>All the services are stored here and it can be used in multiple componets.</p>
  <h4><span class="folderName-title">Stores</span></h4>

     <p>Stores contain the application state and logic. The apps' stores are stored in this folder, to learn more about store, see <a target="blank" href="https://facebook.github.io/flux/docs/overview.html#stores">Flux Architecture</a>.</p>

        <span class="fileName-title">Index.ejs</span>

        <p>The react app gets mounted using,
          <!-- HTML generated using hilite.me --><div class="common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #007700">&lt;div</span> <span style="color: #0000CC">id=</span><span style="background-color: #fff0f0">&quot;mount&quot;</span><span style="color: #007700">&gt;</span>
   <span style="color: #007700">&lt;/div&gt;</span>
</pre></div>
          </p>

        <span class="fileName-title ">Main.jsx</span>

        <p><span class="codeInsidePgrph">ReactDom</span> mounts the app component using,
          <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">ReactDom.render(<span style="color: #333333">&lt;</span>App<span style="color: #333333">/&gt;</span>,<span style="color: #007020">document</span>.getElementById(<span style="background-color: #fff0f0">&#39;mount&#39;</span>));
          </pre></div>
        </p>

          <h2>Server</h2>

        <p>Server folder contains the server files used in the application.</p>

       <h4><span class="folderName-title">Controllers</span></h4>

       <p>The controllers folder contain Express application controllers which deals with backend business logic.</p>

       <h4><span class="folderName-title">Models</span></h4>

       <p>The models folder contain Mongoose models.</p>

       <h4><span class="folderName-title">Routes<span></h4>

       <p>The routes folder contains the Server routing configuration files. The Express routes are defined here. </p>

       <h4><span class="folderName-title">Strategies</span></h4>

       <p>The <b>strategies</b> folder contains the strategies configuration files loaded by the <b>passport.js</b> file.</p>

       <span class="fileName-title ">Express.js</span>

       <p>Express configuration file, it initializes & configures the Express application.</p>

       <span class="fileName-title ">Passport.js</span>

       <p>Passport configuration file that initializes & configures the Passport's authentication strategies and middlewares from the <b>strategies</b> folder.</p>

       <span class="fileName-title ">Seeds.js</span>

       <p>Seeds contain the pre-loaded data.</p>

       <span class="fileName-title ">Server.js</span>

       <p>Node.js application is initialized here.</p>


       <h2>Application Files</h2>

 <p>Few application files are stored in the root folder.</p>

<span class="fileName-title ">gulpfile.js</span>

<p>Gulp is a default JavaScript task runner.</p>

       <h2>.tmp</h2>

       <p id="utf">This folder stores the raw javascript code in <span class="codeInsidePgrph">app.js</span> for the browser.
          Using browserify all the jsx files are compiled to <span class="codeInsidePgrph">app.js</span>.</p>
  </div>
<div>
          <h1>Understanding the Framework</h1>
          <hr>

          <h2>Data Flow Model</h2>
                 <img class="common-margin-bottom" style="max-width: 100%;" src="images/image00.png"/>



          <div>

                    <p>The application architecture used on the client-side for data flow between the React components and the
                      backend is a stripped down version inspired by Facebook’s Flux architecture, and has two main parts
                      - <b>stores</b> and <b>views.</b>
                    </p>

                    <p>Let’s discuss the data flow in  Article list view component from the framework.</p>

                    <p><span class="l-sub-section">In order to access the Article list component, the user first needs to go to the url "/articles" from the <span class="codeInsidePgrph">app.jsx</span> file.</span></p>

          <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5
6
7
8</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #007700">&lt;Router</span> <span style="color: #0000CC">history=</span><span style="background-color: #fff0f0">{history}</span><span style="color: #007700">&gt;</span>
      <span style="color: #007700">&lt;Route</span> <span style="color: #0000CC">path=</span><span style="background-color: #fff0f0">&quot;/&quot;</span> <span style="color: #0000CC">component=</span><span style="background-color: #fff0f0">{Template}</span><span style="color: #007700">&gt;</span>
        <span style="color: #007700">&lt;IndexRoute</span> <span style="color: #0000CC">component=</span><span style="background-color: #fff0f0">{Home}/</span><span style="color: #007700">&gt;</span>
        ..............
        <span style="color: #007700">&lt;Route</span> <span style="color: #0000CC">path=</span><span style="background-color: #fff0f0">&quot;/articles&quot;</span> <span style="color: #0000CC">component=</span><span style="background-color: #fff0f0">{ListArticles}/</span><span style="color: #007700">&gt;</span>
        ..............
      <span style="color: #007700">&lt;/Route&gt;</span>
    <span style="color: #007700">&lt;/Router&gt;</span>
</pre></td></tr></table></div>


                    <p class="l-sub-section">As soon as the Article list view component is initialized, <span class="codeInsidePgrph">ArticleStore.fetchArticleList()</span> function is called.
                    </p>

          <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">class</span> ArticleList <span style="color: #008800; font-weight: bold">extends</span> React.Component {
  constructor(props, context){
    ...
    ArticleStore.fetchArticleList();
    ...
      }
    ...
  }

<b>FIG</b><span style="color: #333333">:</span> Article List Component
</pre></td></tr></table></div>

                    <p class="l-sub-section">The <span class="codeInsidePgrph">fetchArticleList()</span> in the <b>ArticleStore.jsx</b> makes an ajax <b>GET</b> call in order to get the data from
                      the database using the appropriate <b>API</b> call.
                    </p>
                    <p>
                      <b>
                      So when this article list data returns successfully, how is this data rendered in the article list view?
                      </b>
                    </p>

          <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto; background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5</pre></td><td><pre style="margin: 0; line-height: 125%">
_onChange() {
  <span style="color: #008800; font-weight: bold">this</span>.setState(getArticleList());
  }

<b>FIG</b><span style="color: #333333">:</span> onChange function in view
</pre></td></tr></table></div>

                    <p class="l-sub-section">
                      The <span class="codeInsidePgrph">_onChange(){...}</span> function in the ListArticles component is registered in the store
                      as a callback function to be called when the data is available.
                    </p>

          <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto; background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5</pre></td><td><pre style="margin: 0; line-height: 125%">componentWillMount() {
    ArticleStore.onChange(<span style="color: #008800; font-weight: bold">this</span>._onChange);
  }

<b>FIG</b><span style="color: #333333">:</span> onChange <span style="color: #008800; font-weight: bold">function</span> being registered
</pre></td></tr></table></div>

          <p class="l-sub-section"><span class="codeInsidePgrph">(this._onChange)</span> is being pushed to a changeListener array in the store's onChange method, shown below</p>

<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto; background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">function</span> onChange(listener) {
    changeListeners.push(listener);
  }

<b>FIG</b><span style="color: #333333">:</span> onChange function in store
</pre></td></tr></table></div>

          <p> The <span class="codeInsidePgrph">triggerListeners(){...}</span> function is called
          after the data is successfully fetched,and calling the registered callbacks from the array.Then  the <span class="codeInsidePgrph">_onChange()</span> method in react components are executed.
          </p>
<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto; background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5
6
7</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">function</span> triggerListeners() {
    changeListeners.forEach(<span style="color: #008800; font-weight: bold">function</span>(listener) {
      listener();
    })
  };

<b>FIG</b><span style="color: #333333">:</span> Running each registered listener function
</pre></td></tr></table></div>

<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto; background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5
6
7
8</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">function</span> fetchArticleList() {
    get(<span style="background-color: #fff0f0">&quot;/api/articles&quot;</span>).then((data) <span style="color: #333333">=&gt;</span> {
      articleList <span style="color: #333333">=</span> data;
      triggerListeners();
    });
  }

<b>FIG</b><span style="color: #333333">:</span> fetchArticleList() calls the triggerListeners() when data is retrieved
</pre></td></tr></table></div>

<p id="clientSideArticle"><span class="codeInsidePgrph">this.setState(getArticleList());</span>renders the ListArticles component with the updated data.</p>




          </div>



          <h2>Client Side (Article)</h2>
          <h4>Create Article Component</h4>
          <p>
            To understand the framework, start with the example <b>CreateArticle.jsx</b> component. Let’s get straight into the code,
          </p>
<div class="example-title">CreateArticle.jsx</div>
          <!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> React from <span style="background-color: #fff0f0">&#39;react&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> ArticleStore from <span style="background-color: #fff0f0">&#39;./../../stores/ArticleStore.jsx&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {Grid, Row, Col, Panel, Button, Input, ButtonInput} from <span style="background-color: #fff0f0">&#39;react-bootstrap&#39;</span>

<span style="color: #008800; font-weight: bold">class</span> CreateArticle <span style="color: #008800; font-weight: bold">extends</span> React.Component {
  constructor(props) {
    <span style="color: #008800; font-weight: bold">super</span>(props);
    <span style="color: #008800; font-weight: bold">this</span>.history <span style="color: #333333">=</span> props.history;
    <span style="color: #008800; font-weight: bold">this</span>.state <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.error <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;&#39;</span>;

    <span style="color: #008800; font-weight: bold">this</span>.handleInputTitle <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputTitle.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputContent <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputContent.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>._formSubmit <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>._formSubmit.bind(<span style="color: #008800; font-weight: bold">this</span>);
  }
  handleInputTitle(e) {
    <span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle.title <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({CreateArticle<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle});
  }
  handleInputContent(e) {
    <span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle.content <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({CreateArticle<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle});
  }
   _formSubmit(e) {
    e.preventDefault();
    ArticleStore.addArticle(<span style="color: #008800; font-weight: bold">this</span>.state.CreateArticle, <span style="color: #008800; font-weight: bold">this</span>.history);
}


  render() {

    <span style="color: #008800; font-weight: bold">return</span> (
      <span style="color: #333333">&lt;</span>Grid<span style="color: #333333">&gt;</span>
        <span style="color: #333333">&lt;</span>Row<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>}<span style="color: #333333">&gt;</span>
            <span style="color: #333333">&lt;</span>h2<span style="color: #333333">&gt;</span>
              <span style="color: #333333">&lt;</span>b<span style="color: #333333">&gt;</span>Create Article<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/b&gt;</span>
            <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/h2&gt;</span>
            <span style="color: #333333">&lt;</span>form onSubmit<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>._formSubmit}<span style="color: #333333">&gt;</span>
              <span style="color: #333333">&lt;</span>Input type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span> label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Title&quot;</span> onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputTitle} placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Enter Article Title&quot;</span><span style="color: #333333">/&gt;</span>
              <span style="color: #333333">&lt;</span>Input type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;textarea&quot;</span> label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Article Content&quot;</span> onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputContent} placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Article Content: &quot;</span><span style="color: #333333">/&gt;</span>
              <span style="color: #333333">&lt;</span>ButtonInput type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;submit&quot;</span> value<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Submit Button&quot;</span> bsStyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;primary&quot;</span><span style="color: #333333">/&gt;</span>
            <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/form&gt;</span>
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
        <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Row&gt;</span>
      <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Grid&gt;</span>
    )
  }
}

<span style="color: #008800; font-weight: bold">export</span> <span style="color: #008800; font-weight: bold">default</span> CreateArticle;
</pre></td></tr></table></div>


          <p>
            This component is responsible for creating a new Article. The <span class="codeInsidePgrph">handleInputTitle(e) {...}</span>
            and the <span class="codeInsidePgrph">handleInputContent(e) {...}</span> takes the input from the user for the Article Title and Article Content.
            Finally the <span class="codeInsidePgrph">_formSubmit(e) {...}</span> submit the newly created article.
          </p>
          <h4>Edit Article Component</h4>
          <p>
            In this part <b>EditArticle.jsx</b> component will be discussed. Let’s start with the code,
          </p>
<div class="example-title">EditArticle.jsx</div>
          <!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5; border:1px solid #ccc;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> React from <span style="background-color: #fff0f0">&#39;react&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> ArticleStore from <span style="background-color: #fff0f0">&#39;./../../stores/ArticleStore.jsx&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {Grid, Row, Col, Panel, Button, Input, ButtonInput} from <span style="background-color: #fff0f0">&#39;react-bootstrap&#39;</span>

<span style="color: #008800; font-weight: bold">function</span> getArticle() {
    <span style="color: #008800; font-weight: bold">return</span> {EditArticle<span style="color: #333333">:</span> ArticleStore.getArticle()}
}

<span style="color: #008800; font-weight: bold">class</span> EditArticle <span style="color: #008800; font-weight: bold">extends</span> React.Component {
  constructor(props) {
    <span style="color: #008800; font-weight: bold">super</span>(props);
      <span style="color: #008800; font-weight: bold">this</span>.state <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.history <span style="color: #333333">=</span> props.history;
    ArticleStore.fetchArticle(props.params.id);

    <span style="color: #008800; font-weight: bold">this</span>.state<span style="color: #333333">=</span>getArticle();
    <span style="color: #008800; font-weight: bold">this</span>.handleInputTitle <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputTitle.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputContent <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputContent.bind(<span style="color: #008800; font-weight: bold">this</span>);
      <span style="color: #008800; font-weight: bold">this</span>._onChange <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>._onChange.bind( <span style="color: #008800; font-weight: bold">this</span> );
    <span style="color: #008800; font-weight: bold">this</span>._formSubmit <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>._formSubmit.bind(<span style="color: #008800; font-weight: bold">this</span>);
  }
  handleInputTitle(e) {
    <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle.title <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({EditArticle<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle});
  }

  handleInputContent(e) {
    <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle.content <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({EditArticle<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle});
  }
  _formSubmit(e) {
    e.preventDefault();
    ArticleStore.editArticle(<span style="color: #008800; font-weight: bold">this</span>.state.EditArticle, <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle._id,<span style="color: #008800; font-weight: bold">this</span>.history);
  }
  componentWillMount() {
      ArticleStore.onChange(<span style="color: #008800; font-weight: bold">this</span>._onChange);
  }

  componentWillUnmount() {
     ArticleStore.removeChangeListener( <span style="color: #008800; font-weight: bold">this</span>._onChange );
  }
  _onChange() {
      <span style="color: #008800; font-weight: bold">this</span>.setState( getArticle() );
  }

  render() {
<span style="color: #008800; font-weight: bold">var</span> article <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.state.EditArticle;

    <span style="color: #008800; font-weight: bold">return</span> (
      <span style="color: #333333">&lt;</span>Grid<span style="color: #333333">&gt;</span>
        <span style="color: #333333">&lt;</span>Row<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>}<span style="color: #333333">&gt;</span>
            <span style="color: #333333">&lt;</span>h2<span style="color: #333333">&gt;</span>
              <span style="color: #333333">&lt;</span>b<span style="color: #333333">&gt;</span>Edit Article<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/b&gt;</span>
            <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/h2&gt;</span>
            <span style="color: #333333">&lt;</span>form onSubmit<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>._formSubmit}<span style="color: #333333">&gt;</span>
              <span style="color: #333333">&lt;</span>Input type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span> value<span style="color: #333333">=</span>{article.title} label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Title&quot;</span> onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputTitle} placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Enter Article Title&quot;</span><span style="color: #333333">/&gt;</span>
              <span style="color: #333333">&lt;</span>Input type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;textarea&quot;</span> value<span style="color: #333333">=</span>{article.content} label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Article Content&quot;</span> onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputContent} placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Article Content: &quot;</span><span style="color: #333333">/&gt;</span>
              <span style="color: #333333">&lt;</span>ButtonInput type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;submit&quot;</span> value<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Submit Button&quot;</span> bsStyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;primary&quot;</span><span style="color: #333333">/&gt;</span>
            <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/form&gt;</span>
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
        <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Row&gt;</span>
      <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Grid&gt;</span>
    )
  }
}

<span style="color: #008800; font-weight: bold">export</span> <span style="color: #008800; font-weight: bold">default</span> EditArticle;
</pre></td></tr></table></div>
<p>This component is responsible for updating an Article.
<span class="codeInsidePgrph">ArticleStore.fetchArticle(props.params.id);</span> retrieves the desired article by it's ID
from the list to be updated.
</p>
<p>
  Inside <span class="codeInsidePgrph">handleInputTitle(e) {...}</span>, <span class="codeInsidePgrph">this.state.EditArticle.title = e.target.value;</span>
  takes the input from the user to update the Article Title and
  <span class="codeInsidePgrph">this.setState({EditArticle: this.state.EditArticle});</span>.
  updates the object whenever changes are made.
</p>
<p>
  The <span class="codeInsidePgrph">handleInputContent(e) {...}</span> does exactly same thing as the
  <span class="codeInsidePgrph">handleInputTitle(e) {...}</span>. Finally,
  the <span class="codeInsidePgrph">_formSubmit(e) {...}</span> submit the updated article.
</p>

<h4>View Article Component</h4>

<p>
  The <b>ViewArticle.jsx</b> component is almost similar with the <b>EditArticle.jsx</b> component, It allows
  the user to <b>view</b>, <b>delete</b> and <b>edit</b> an article. <b>Delete</b> and <b>edit</b> works only if the user is logged in.
</p>
<div class="example-title">ViewArticle.jsx</div>
<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> React from <span style="background-color: #fff0f0">&#39;react&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> { Link } from <span style="background-color: #fff0f0">&#39;react-router&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> ArticleStore from <span style="background-color: #fff0f0">&#39;./../../stores/ArticleStore.jsx&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {Grid, Row, Col, Panel, Pagination,Button, Well, Label} from <span style="background-color: #fff0f0">&#39;react-bootstrap&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {LinkContainer} from <span style="background-color: #fff0f0">&#39;react-router-bootstrap&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> auth from <span style="background-color: #fff0f0">&#39;./../../services/Authentication&#39;</span>;

<span style="color: #008800; font-weight: bold">function</span> getArticle() {
    <span style="color: #008800; font-weight: bold">return</span> {article<span style="color: #333333">:</span> ArticleStore.getArticle()}
}

<span style="color: #008800; font-weight: bold">class</span> ViewArticle <span style="color: #008800; font-weight: bold">extends</span> React.Component {
  constructor(props, context){
    <span style="color: #008800; font-weight: bold">super</span>(props, context);
    ArticleStore.fetchArticle(props.params.id);
    ArticleStore.fetchArticleList();
    <span style="color: #008800; font-weight: bold">this</span>.state <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.article <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.loggedIn <span style="color: #333333">=</span> auth.loggedIn();
    <span style="color: #008800; font-weight: bold">this</span>.state.articleID <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.props.params.id;
    <span style="color: #008800; font-weight: bold">this</span>._onChange <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>._onChange.bind( <span style="color: #008800; font-weight: bold">this</span> );
    <span style="color: #008800; font-weight: bold">this</span>.deleteArticle <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.deleteArticle.bind(<span style="color: #008800; font-weight: bold">this</span>);
  }

  componentWillMount() {
    ArticleStore.onChange(<span style="color: #008800; font-weight: bold">this</span>._onChange);
  }
 componentWillUnmount() {
    ArticleStore.removeChangeListener(<span style="color: #008800; font-weight: bold">this</span>._onChange);
  }
  _onChange() {
    <span style="color: #008800; font-weight: bold">this</span>.setState( getArticle());
  }

  deleteArticle() {
     ArticleStore.deleteArticle(<span style="color: #008800; font-weight: bold">this</span>.state.articleID, <span style="color: #008800; font-weight: bold">this</span>.props.history);
  }

  render(){
          <span style="color: #008800; font-weight: bold">var</span> article <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.state.article;

  		<span style="color: #008800; font-weight: bold">return</span> (
        <span style="color: #333333">&lt;</span>Grid<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>Row<span style="color: #333333">&gt;</span>
        <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>} lg<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>} sm<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>} xs<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>}<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>h1<span style="color: #333333">&gt;</span>{article.title}<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/h1&gt;</span>
          <span style="color: #333333">&lt;</span>hr<span style="color: #333333">&gt;&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/hr&gt;</span>
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
          <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">8</span>} lg<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">8</span>} sm<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">8</span>} xs<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">8</span>}<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>h3<span style="color: #333333">&gt;</span>{article.content}<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/h3&gt;</span>
        <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
        <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">4</span>} lg<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">4</span>} sm<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">4</span>} xs<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">4</span>}<span style="color: #333333">&gt;</span>
          {<span style="color: #008800; font-weight: bold">this</span>.state.loggedIn <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&lt;</span>div className<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;pull-right&quot;</span><span style="color: #333333">&gt;</span>
            <span style="color: #333333">&lt;</span>LinkContainer className<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;editBtnCSS&quot;</span> to<span style="color: #333333">=</span>{<span style="color: #FF0000; background-color: #FFAAAA">`</span><span style="color: #333333">/</span>articles<span style="color: #333333">/</span>edit<span style="color: #333333">/</span>${article._id}<span style="color: #FF0000; background-color: #FFAAAA">`</span>}<span style="color: #333333">&gt;&lt;</span>Button  bsStyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;primary&quot;</span><span style="color: #333333">&gt;</span>Edit<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Button&gt;&lt;/LinkContainer&gt;</span>
            <span style="color: #333333">&lt;</span>Button onClick<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.deleteArticle} bsStyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;danger&quot;</span><span style="color: #333333">&gt;</span>Delete<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Button&gt;</span>
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/div&gt;</span>
          }
      <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
         <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Row&gt;</span>
      <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Grid&gt;</span>
      )
    }
}

<span style="color: #008800; font-weight: bold">export</span> <span style="color: #008800; font-weight: bold">default</span> ViewArticle;
</pre></td></tr></table></div>

<p id = "serverSideArticle">
  Inside the <span class="codeInsidePgrph">render(){...} this.state.loggedIn &&</span> shows the Edit & Delete Button if the user logged in.

</p>
        </div>
        <!-- /*********************** new component backend start**********************/ -->

             <div>
             <h2>Server Side (Article)</h2>


            <p class="l-sub-section">
              The <span class="codeInsidePgrph">Article.js</span> contains the article schema using mongoose.
            </p>
<div class="example-title">Article.js</div>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">
     1
     2
     3
     4
     5
     6
     7
     8
     9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">var</span> mongoose <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;mongoose&#39;</span>);
    <span style="color: #008800; font-weight: bold">var</span> Schema <span style="color: #333333">=</span> mongoose.Schema;
    <span style="color: #008800; font-weight: bold">var</span> ArticleSchema <span style="color: #333333">=</span> {

      title<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
      },

      content<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
      },

      user<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> Schema.ObjectId,
        ref<span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;User&#39;</span>
      },

      created<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">Date</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="color: #007020">Date</span>.now
      }
    }

    <span style="color: #008800; font-weight: bold">var</span> Article <span style="color: #333333">=</span> mongoose.model(<span style="background-color: #fff0f0">&#39;Article&#39;</span>, ArticleSchema, <span style="background-color: #fff0f0">&#39;articles&#39;</span>);
    module.exports <span style="color: #333333">=</span> Article;
  </pre></td></tr></table>

</div>

<p class="l-sub-section">
  Backend API routes are written in <span class="codeInsidePgrph">server.routes.js</span>. Depending on the route being called, the appropriate function will be executed.
</p>
<div class="example-title">article.server.routes.js</div>
<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;background-color: #f5f5f5;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td><pre style="margin: 0; line-height: 125%">module.exports <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(app){

 <span style="color: #008800; font-weight: bold">var</span> articles <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;./../controllers/articles.server.controller.js&#39;</span>);
 <span style="color: #008800; font-weight: bold">var</span> users <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;./../controllers/users.server.controller.js&#39;</span>);

 app.route(<span style="background-color: #fff0f0">&#39;/api/articles&#39;</span>)
	.get(articles.list)
	.post(users.requiresLogin, articles.create);

  app.route(<span style="background-color: #fff0f0">&#39;/articles/api/articles/:id&#39;</span>)
	.get(articles.read)
  .<span style="color: #008800; font-weight: bold">delete</span>(users.requiresLogin, articles.<span style="color: #008800; font-weight: bold">delete</span>);

	app.route(<span style="background-color: #fff0f0">&#39;/articles/edit/api/articles/:id&#39;</span>)
	.get(articles.read)
	.put(users.requiresLogin, articles.update);


app.param(<span style="background-color: #fff0f0">&#39;id&#39;</span>, articles.articleByID);


}
</pre></td></tr></table></div>

<p>The route <span class="codeInsidePgrph">'/api/articles'</span> lets a user create an article if the user is logged in and gets the list of articles.
</p>

<p>The route <span class="codeInsidePgrph">'/articles/api/articles/:id'</span> lets a user delete an article if the user is logged in and gets one article.</p>

<p>The route <span class="codeInsidePgrph">'/articles/edit/api/articles/:id'</span> lets a user edit an article if the user is logged in and gets one article.</p>

<p><span class="codeInsidePgrph">users.requiresLogin</span> is added to any route if user authentication is required to access that route.</p>

<p>Using http <span class="codeInsidePgrph">“put”</span> method and the following url <span class="codeInsidePgrph">/articles/edit/api/articles/569cbefe877baaf001e43b7f'</span>
the article with the id <b>569cbefe877baaf001e43b7f</b> can be updated.
</p>

<p>Using http <span class="codeInsidePgrph">“get”</span> method and the following url <span class="codeInsidePgrph">'/articles/api/articles/569cbefe877baaf001e43b7f</span>
the article with the id <b>569cbefe877baaf001e43b7f</b> can be retrieved .
</p>


<p>Using http <span class="codeInsidePgrph">“post”</span> method and the following url <span class="codeInsidePgrph">'/api/articles'</span>
an article can be created.
</p>

<p>Using http <span class="codeInsidePgrph">“delete”</span> method and the following url <span class="codeInsidePgrph">'/articles/api/articles/569cbefe877baaf001e43b7f</span>
the article with the id <b>569cbefe877baaf001e43b7f</b> can be deleted.
</p>


<p><span class="codeInsidePgrph">app.param</span> gets a single article from the database if the url param contains an <b>id</b> parameter.</p>


<p class="l-sub-section">The CRUD operation functions are defined in the <span class="codeInsidePgrph">server.controller.js</span> file. </p>
<p> The file from the models folder needs to be imported to <span class="codeInsidePgrph">server.controller.js</span> in order to save, update and delete data.
 <span class="codeInsidePgrph">server.controller.js</span> provides all the functions that the <span class="codeInsidePgrph">server.routes.js</span> uses such as list, create, etc.</p>

<div class="example-title">articles.server.controller.js</div>
<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;border:solid gray;background-color: #f5f5f5;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">var</span> mongoose <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;mongoose&#39;</span>);
<span style="color: #008800; font-weight: bold">var</span> Article <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;./../models/Article.js&#39;</span>);
<span style="color: #008800; font-weight: bold">var</span> _ <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;lodash&#39;</span>);

module.exports.list <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
  Article.find(<span style="color: #008800; font-weight: bold">function</span>(error, data) {
    <span style="color: #008800; font-weight: bold">if</span> (error) {} <span style="color: #008800; font-weight: bold">else</span> {
      res.send(data);
    }
  });
};

module.exports.create <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
  <span style="color: #008800; font-weight: bold">var</span> article <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Article(req.body);
  article.user <span style="color: #333333">=</span> req.user;
  article.save(<span style="color: #008800; font-weight: bold">function</span>(err, data) {
    <span style="color: #008800; font-weight: bold">if</span> (err) {
      res.status(<span style="color: #0000DD; font-weight: bold">501</span>).send();
    } <span style="color: #008800; font-weight: bold">else</span> {
      res.status(<span style="color: #0000DD; font-weight: bold">200</span>).send(data);
    }
  });
};

module.exports.read <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
  res.json(req.article);
};


exports.<span style="color: #008800; font-weight: bold">delete</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
	<span style="color: #008800; font-weight: bold">var</span> article <span style="color: #333333">=</span> req.article;
	article.remove(<span style="color: #008800; font-weight: bold">function</span>(err) {
		<span style="color: #008800; font-weight: bold">if</span> (err) {
			<span style="color: #008800; font-weight: bold">return</span> res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send();
		} <span style="color: #008800; font-weight: bold">else</span> {
			res.json(article);
		}
	});
};


module.exports.update <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
  <span style="color: #008800; font-weight: bold">var</span> article <span style="color: #333333">=</span> req.article;

  	article <span style="color: #333333">=</span> _.extend(article, req.body);

  	article.save(<span style="color: #008800; font-weight: bold">function</span>(err) {
  		<span style="color: #008800; font-weight: bold">if</span> (err) {
  			<span style="color: #008800; font-weight: bold">return</span> res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send();
  		} <span style="color: #008800; font-weight: bold">else</span> {
  			res.json(article);
  		}
  	});
};

exports.articleByID <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res, next, id) {
	Article.findById(id).populate(<span style="background-color: #fff0f0">&#39;user&#39;</span>, <span style="background-color: #fff0f0">&#39;email&#39;</span>).exec(<span style="color: #008800; font-weight: bold">function</span>(err, article) {
		<span style="color: #008800; font-weight: bold">if</span> (err) <span style="color: #008800; font-weight: bold">return</span> next(err);
		<span style="color: #008800; font-weight: bold">if</span> (<span style="color: #333333">!</span>article) <span style="color: #008800; font-weight: bold">return</span> next(<span style="color: #008800; font-weight: bold">new</span> <span style="color: #007020">Error</span>(<span style="background-color: #fff0f0">&#39;Failed to load article &#39;</span> <span style="color: #333333">+</span> id));
		req.article <span style="color: #333333">=</span> article;
		next();
	});
};
</pre></td></tr></table></div>


<p><span class="codeInsidePgrph">module.exports.list()</span> gives the user the list of articles.</p>

<p><span class="codeInsidePgrph">module.exports.create()</span> lets the user create an article by calling the save method on the model.</p>

<p><span class="codeInsidePgrph">module.exports.update()</span> lets the user edit an article by calling the save method on the model after changing the original data into the the edited one which came from <span class="codeInsidePgrph">req.body</span>.</p>

<p><span class="codeInsidePgrph">exports.delete()</span> lets the user delete an article by calling the remove method on the model.</p>

<p><span class="codeInsidePgrph">exports.articleByID()</span> finds a single article based on id for <span class="codeInsidePgrph">module.exports.update()</span> or <span class="codeInsidePgrph">exports.delete()</span> to use.</p>


<p>An example of the json format of the data that returned when <span class="codeInsidePgrph">http://localhost:9001/api/articles</span> is called is given below,</p>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5; border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #FF0000; background-color: #FFAAAA">:</span>
{
<span style="color: #007700">&quot;_id&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b7f&quot;</span>
<span style="background-color: #fff0f0">&quot;user&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b7e&quot;</span>
<span style="background-color: #fff0f0">&quot;__v&quot;</span>: <span style="color: #0000DD; font-weight: bold">0</span>
<span style="background-color: #fff0f0">&quot;created&quot;</span>: <span style="background-color: #fff0f0">&quot;2016-01-18T10:31:26.834Z&quot;</span>
<span style="background-color: #fff0f0">&quot;content&quot;</span>: <span style="background-color: #fff0f0">&quot;content for article 1&quot;</span>
<span style="background-color: #fff0f0">&quot;title&quot;</span>: <span style="background-color: #fff0f0">&quot;article 1&quot;</span>
}

<span style="color: #0000DD; font-weight: bold">1</span><span style="color: #FF0000; background-color: #FFAAAA">:</span>
{
<span style="color: #007700">&quot;_id&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b80&quot;</span>
<span style="background-color: #fff0f0">&quot;user&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b7e&quot;</span>
<span style="background-color: #fff0f0">&quot;__v&quot;</span>: <span style="color: #0000DD; font-weight: bold">0</span>
<span style="background-color: #fff0f0">&quot;created&quot;</span>: <span style="background-color: #fff0f0">&quot;2016-01-18T10:31:26.836Z&quot;</span>
<span style="background-color: #fff0f0">&quot;content&quot;</span>: <span style="background-color: #fff0f0">&quot;content for article 2&quot;</span>
<span style="background-color: #fff0f0">&quot;title&quot;</span>: <span style="background-color: #fff0f0">&quot;article 2&quot;</span>
}

<span  id="signUp" style="color: #0000DD; font-weight: bold">2</span><span style="color: #FF0000; background-color: #FFAAAA">:</span>
{
<span style="color: #007700">&quot;_id&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b81&quot;</span>
<span style="background-color: #fff0f0">&quot;user&quot;</span>: <span style="background-color: #fff0f0">&quot;569cbefe877baaf001e43b7e&quot;</span>
<span style="background-color: #fff0f0">&quot;__v&quot;</span>: <span style="color: #0000DD; font-weight: bold">0</span>
<span style="background-color: #fff0f0">&quot;created&quot;</span>: <span style="background-color: #fff0f0">&quot;2016-01-18T10:31:26.836Z&quot;</span>
<span style="background-color: #fff0f0">&quot;content&quot;</span>: <span style="background-color: #fff0f0">&quot;content for article 3&quot;</span>
<span  id="clientSideSignUp" style="background-color: #fff0f0">&quot;title&quot;</span>: <span style="background-color: #fff0f0">&quot;article 3&quot;</span>
}
</pre></td></tr></table></div>
           </div>


           <!-- /*********************** new component backend end **********************/ -->
      <div>
           <h2>Client Side (Sign Up)</h2>
           <p>
             The <b>Signup.jsx</b> component is all about creating a new user to the the application. The following instructions will show how to signup a user with validation in the front-end.
           </p>

           <!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5; border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> React from <span style="background-color: #fff0f0">&#39;react&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> { Link } from <span style="background-color: #fff0f0">&#39;react-router&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {Grid, Row, Col, Panel, Pagination,Button, Well, Label, Input, ButtonInput, MenuItem} from <span style="background-color: #fff0f0">&#39;react-bootstrap&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> {LinkContainer} from <span style="background-color: #fff0f0">&#39;react-router-bootstrap&#39;</span>;
<span style="color: #008800; font-weight: bold">import</span> auth from <span style="background-color: #fff0f0">&#39;./../../services/Authentication&#39;</span>;

<span style="color: #008800; font-weight: bold">class</span> Signup <span style="color: #008800; font-weight: bold">extends</span> React.Component {
  constructor(props, context){
    <span style="color: #008800; font-weight: bold">super</span>(props, context);
    <span style="color: #008800; font-weight: bold">this</span>.state <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.userInfo <span style="color: #333333">=</span> {};
    <span style="color: #008800; font-weight: bold">this</span>.state.error <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;&#39;</span>;
    <span style="color: #008800; font-weight: bold">this</span>.state.email <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;&#39;</span>;
    <span style="color: #008800; font-weight: bold">this</span>.state.password <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;&#39;</span>;
    <span style="color: #008800; font-weight: bold">this</span>.validPassword<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">false</span>;
    <span style="color: #008800; font-weight: bold">this</span>.history <span style="color: #333333">=</span> props.history;
    <span style="color: #008800; font-weight: bold">this</span>.handleInputFirstName <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputFirstName.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputLastName <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputLastName.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputEmail <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputEmail.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputUserName <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.handleInputUserName.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.handleInputPassword <span style="color: #333333">=</span>  <span style="color: #008800; font-weight: bold">this</span>.handleInputPassword.bind(<span style="color: #008800; font-weight: bold">this</span>);
    <span style="color: #008800; font-weight: bold">this</span>.formSubmit <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.formSubmit.bind(<span style="color: #008800; font-weight: bold">this</span>);
  }


  validateEmail(email) {
    <span style="color: #008800; font-weight: bold">var</span> re <span style="color: #333333">=</span> <span style="color: #000000; background-color: #fff0ff">/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i</span>;<span style="color: #000000; background-color: #fff0ff">/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i</span>;
    <span style="color: #008800; font-weight: bold">return</span> re.test(email);
  }

  handleInputFirstName(e){
    <span style="color: #008800; font-weight: bold">this</span>.validFirstName<span style="color: #333333">=</span> e.target.value<span style="color: #333333">!==</span><span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #333333">?</span> <span style="color: #008800; font-weight: bold">true</span> <span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">false</span>;
    <span style="color: #008800; font-weight: bold">this</span>.state.userInfo.firstName <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({userInfo<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo});
    <span style="color: #008800; font-weight: bold">this</span>.setState({error<span style="color: #333333">:</span><span style="background-color: #fff0f0">&#39;&#39;</span>});
  }

  handleInputLastName(e){
    <span style="color: #008800; font-weight: bold">this</span>.validLastName<span style="color: #333333">=</span> e.target.value<span style="color: #333333">!==</span><span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #333333">?</span> <span style="color: #008800; font-weight: bold">true</span> <span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">false</span>;
    <span style="color: #008800; font-weight: bold">this</span>.state.userInfo.lastName <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({userInfo<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo});
    <span style="color: #008800; font-weight: bold">this</span>.setState({error<span style="color: #333333">:</span><span style="background-color: #fff0f0">&#39;&#39;</span>});
  }

  handleInputEmail(e){
    <span style="color: #008800; font-weight: bold">this</span>.validEmail<span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.validateEmail(e.target.value)
    <span style="color: #008800; font-weight: bold">this</span>.state.userInfo.email <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({userInfo <span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo});
    <span style="color: #008800; font-weight: bold">this</span>.setState({error<span style="color: #333333">:</span><span style="background-color: #fff0f0">&#39;&#39;</span>});
  }

  handleInputUserName(e){
    <span style="color: #008800; font-weight: bold">this</span>.validUserName<span style="color: #333333">=</span> e.target.value<span style="color: #333333">!==</span><span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #333333">?</span> <span style="color: #008800; font-weight: bold">true</span> <span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">false</span>;
    <span style="color: #008800; font-weight: bold">this</span>.state.userInfo.username <span style="color: #333333">=</span> e.target.value;
    <span style="color: #008800; font-weight: bold">this</span>.setState({userInfo<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo});
    <span style="color: #008800; font-weight: bold">this</span>.setState({error<span style="color: #333333">:</span><span style="background-color: #fff0f0">&#39;&#39;</span>});
  }

  handleInputPassword(e){
    <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>});
    <span style="color: #008800; font-weight: bold">if</span>(e.target.value.length <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">6</span>){
      <span style="color: #008800; font-weight: bold">this</span>.validatePassword<span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">false</span>;
    }
    <span style="color: #008800; font-weight: bold">else</span> {
      <span style="color: #008800; font-weight: bold">this</span>.validPassword<span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">true</span>;
      <span style="color: #008800; font-weight: bold">this</span>.state.userInfo.password <span style="color: #333333">=</span> e.target.value;
    }
    <span style="color: #008800; font-weight: bold">this</span>.setState({userInfo<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo});
  }

  formSubmit(e) {
    e.preventDefault();

    <span style="color: #008800; font-weight: bold">if</span>(<span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.validFirstName){
          <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Please Input the First Name&#39;</span>});
        }
    <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span>(<span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.validLastName){
              <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Please Input the Last Name&#39;</span>});
            }
            <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span>(<span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.validEmail){
                      <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Please Input Correct Email Address&#39;</span>});
                    }
    <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span>(<span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.validUserName){
            <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Please Input the User Name&#39;</span>});
        }
        <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span>(<span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.validPassword){
                <span style="color: #008800; font-weight: bold">this</span>.setState({error <span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Password Should Be Longer than 6 Charecters&#39;</span>});
            }
    <span style="color: #008800; font-weight: bold">else</span>{
      <span style="color: #008800; font-weight: bold">var</span> newUser <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.state.userInfo;
      auth.signup(newUser);
    }
  }

  render() {
    <span style="color: #008800; font-weight: bold">return</span>(
      <span style="color: #333333">&lt;</span>Grid<span style="color: #333333">&gt;</span>
        <span style="color: #333333">&lt;</span>Row<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>h2<span style="color: #333333">&gt;</span>
            Sign up Using Email
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/h2&gt;</span>
          <span style="color: #333333">&lt;</span>hr<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Col md<span style="color: #333333">=</span>{<span style="color: #0000DD; font-weight: bold">12</span>}<span style="color: #333333">&gt;</span>


        <span style="color: #333333">&lt;</span>form onSubmit<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.formSubmit}<span style="color: #333333">&gt;</span>
          <span style="color: #333333">&lt;</span>Input
            placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;First Name&quot;</span>
            onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputFirstName}
            label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;First Name&quot;</span>
            type <span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span> <span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>br<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Input
            placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Last Name&quot;</span>
            onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputLastName}
            label <span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Last Name&quot;</span>
            type <span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span><span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>br<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Input
            placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Enter Email&quot;</span>
            onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputEmail}
            label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Email&quot;</span>
            type <span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span><span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>br<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Input
            placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;User Name&quot;</span>
            onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputUserName}
            label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;User Name&quot;</span>
            type <span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;text&quot;</span><span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>br<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Input
            placeholder<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Enter Password&quot;</span>
            onChange<span style="color: #333333">=</span>{<span style="color: #008800; font-weight: bold">this</span>.handleInputPassword}
            label<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;Password&quot;</span>
            type<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;password&quot;</span> <span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>br<span style="color: #333333">/&gt;</span>
          <span style="color: #333333">&lt;</span>Button bsStyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;primary&quot;</span><span style="color: #333333">&gt;</span>
            Sign up
          <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Button&gt; &amp;nbsp; or&amp;nbsp;</span>
          <span style="color: #333333">&lt;</span>LinkContainer to<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;/signin&quot;</span><span style="color: #333333">&gt;&lt;</span>a<span style="color: #333333">&gt;</span>Sign In<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/a&gt;&lt;/LinkContainer&gt;</span>
          <span style="color: #333333">&lt;</span>p<span style="color: #333333">&gt;</span>{<span style="color: #008800; font-weight: bold">this</span>.state.error}<span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/p&gt;</span>
        <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/form&gt;</span>
      <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Col&gt;</span>
    <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Row&gt;</span>
  <span style="color: #333333">&lt;</span><span style="color: #FF0000; background-color: #FFAAAA">/Grid&gt;</span>
    )
  }
}
<span style="color: #008800; font-weight: bold">export</span> <span style="color: #008800; font-weight: bold">default</span> Signup;
</pre></td></tr></table></div>
<p>
  After providing all the valid information for the required fields in the signup form, this component allows a user to be added to the DB. Lets start the coding explanation,
</p>

<p>
  <span class="codeInsidePgrph">handleInputFirstName(e){...}, handleInputLastName(e){...}, handleInputUserName(e){...}</span> does exactly the same thing.
  So <span class="codeInsidePgrph">handleInputFirstName(e){...}</span> will be described in order to understand these three methods.
   <span class="codeInsidePgrph">this.validFirstName= e.target.value!=="" ? true : false;</span> this itinerary condition checks whether the First Name field is empty or not. If the field is empty,
</p>
<p>
  <span class="codeInsidePgrph">this.setState({error:''});</span> will show an error message to the user after the form submit button is pressed.

<span class="codeInsidePgrph">this.state.userInfo.firstName = e.target.value;</span> this line of code takes the First Name as input from the user.

<span class="codeInsidePgrph">this.setState({userInfo: this.state.userInfo});</span> updates the <span class="codeInsidePgrph">userInfo{}</span> with the first name.

The <span class="codeInsidePgrph">handleInputEmail(e){...}</span> and <span class="codeInsidePgrph">handleInputPassword(e){...}</span> does pretty much the same thing,

<span class="codeInsidePgrph">this.validEmail= this.validateEmail(e.target.value)</span> gets the valid/invalid email using the <span class="codeInsidePgrph">validateEmail(email){...}</span> method and responds accordingly.

<span class="codeInsidePgrph">validateEmail(email){...}</span> returns a boolean whether the given email address is valid or not using the regex expression.

Finally, <span  id="serverSideSignUp" class="codeInsidePgrph">formSubmit(e){...}</span>
adds a new user by calling auth.signup(newUser);  using the <b>authentication.js</b> service.
If the user provides invalid information, error messages are shown.
</p>
<h2>Server Side (Sign Up)</h2>
<h4>Authentication.js</h4>

<p><span class="codeInsidePgrph">signup(userInfo){...}</span> creates a user.</p>
<p><span class="codeInsidePgrph">login(email, pass, cb) {...}</span> signs in a user using their email and password.</p>
<p><span class="codeInsidePgrph">logout(cb){...}</span> signs out the user.</p>
<p><span class="codeInsidePgrph">loggedIn(){...}</span> checks whether the user is signed in or not.</p>

<p>
For authentication purposes, developers can either use the backend session and send it to the
front-end cookie or use the token system that is stored in the front end.
</p>
      </div>

                  <!-- /*********************** new signup backend **********************/ -->
<div>

<p class="l-sub-section"><span class="codeInsidePgrph">User.js</span> file contains the schema of the user</p>
<div class="example-title">User.js</div>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; background-color: #f5f5f5;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">var</span> mongoose <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;mongoose&#39;</span>),
    Schema <span style="color: #333333">=</span> mongoose.Schema,
    crypto <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;crypto&#39;</span>);

<span style="color: #888888">/**</span>
<span style="color: #888888"> * A Validation function for local strategy properties</span>
<span style="color: #888888"> */</span>
<span style="color: #008800; font-weight: bold">var</span> validateLocalStrategyProperty <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(property) {
    <span style="color: #008800; font-weight: bold">return</span> ((<span style="color: #008800; font-weight: bold">this</span>.provider <span style="color: #333333">!==</span> <span style="background-color: #fff0f0">&#39;local&#39;</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span><span style="color: #008800; font-weight: bold">this</span>.updated) <span style="color: #333333">||</span> property.length);
};

<span style="color: #888888">/**</span>
<span style="color: #888888"> * A Validation function for local strategy password</span>
<span style="color: #888888"> */</span>
<span style="color: #008800; font-weight: bold">var</span> validateLocalStrategyPassword <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(password) {
    <span style="color: #008800; font-weight: bold">return</span> (<span style="color: #008800; font-weight: bold">this</span>.provider <span style="color: #333333">!==</span> <span style="background-color: #fff0f0">&#39;local&#39;</span> <span style="color: #333333">||</span> (password <span style="color: #333333">&amp;&amp;</span> password.length <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">6</span>));
};

<span style="color: #888888">/**</span>
<span style="color: #888888"> * User Schema</span>
<span style="color: #888888"> */</span>
<span style="color: #008800; font-weight: bold">var</span> UserSchema <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Schema({

    firstName<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>
              },

    lastName<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>

    },

    displayName<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },

    email<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>,
        unique<span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Email already exists&#39;</span>,

        match<span style="color: #333333">:</span> [<span style="color: #000000; background-color: #fff0ff">/.+\@.+\..+/</span>, <span style="background-color: #fff0f0">&#39;Please fill a valid email address&#39;</span>]
    },
    username<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },
    photo<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;http://www.ee-ip.org/sites/default/files/default_images/default-user.png&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },
    description<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },
    linkedin<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },
    twitter<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        trim<span style="color: #333333">:</span> <span style="color: #008800; font-weight: bold">true</span>
    },
    password<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;&#39;</span>,
        validate<span style="color: #333333">:</span> [validateLocalStrategyPassword, <span style="background-color: #fff0f0">&#39;Password should be longer&#39;</span>]
    },
    salt<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>
    },
    provider<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
        required<span style="color: #333333">:</span> <span style="background-color: #fff0f0">&#39;Provider is required&#39;</span>
    },
    providerData<span style="color: #333333">:</span> {},
    additionalProvidersData<span style="color: #333333">:</span> {},
    roles<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> [{
            type<span style="color: #333333">:</span> <span style="color: #007020">String</span>,
            <span style="color: #008800; font-weight: bold">enum</span><span style="color: #333333">:</span> [<span style="background-color: #fff0f0">&#39;user&#39;</span>, <span style="background-color: #fff0f0">&#39;admin&#39;</span>]
        }],
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> [<span style="background-color: #fff0f0">&#39;user&#39;</span>]
    },
    updated<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">Date</span>
    },
    created<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">Date</span>,
        <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span> <span style="color: #007020">Date</span>.now
    },
    <span style="color: #888888">/* For reset password */</span>
    resetPasswordToken<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">String</span>
    },
    resetPasswordExpires<span style="color: #333333">:</span> {
        type<span style="color: #333333">:</span> <span style="color: #007020">Date</span>
    }
});

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Hook a pre save method to hash the password</span>
<span style="color: #888888"> */</span>
UserSchema.pre(<span style="background-color: #fff0f0">&#39;save&#39;</span>, <span style="color: #008800; font-weight: bold">function</span>(next) {
    <span style="color: #008800; font-weight: bold">if</span> (<span style="color: #008800; font-weight: bold">this</span>.password <span style="color: #333333">&amp;&amp;</span> <span style="color: #008800; font-weight: bold">this</span>.password.length <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">6</span>) {
        <span style="color: #008800; font-weight: bold">this</span>.salt <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Buffer(crypto.randomBytes(<span style="color: #0000DD; font-weight: bold">16</span>).toString(<span style="background-color: #fff0f0">&#39;base64&#39;</span>), <span style="background-color: #fff0f0">&#39;base64&#39;</span>);
        <span style="color: #008800; font-weight: bold">this</span>.password <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">this</span>.hashPassword(<span style="color: #008800; font-weight: bold">this</span>.password);
    }

    next();
});

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Create instance method for hashing a password</span>
<span style="color: #888888"> */</span>
UserSchema.methods.hashPassword <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(password) {
    <span style="color: #008800; font-weight: bold">if</span> (<span style="color: #008800; font-weight: bold">this</span>.salt <span style="color: #333333">&amp;&amp;</span> password) {
        <span style="color: #008800; font-weight: bold">return</span> crypto.pbkdf2Sync(password, <span style="color: #008800; font-weight: bold">this</span>.salt, <span style="color: #0000DD; font-weight: bold">10000</span>, <span style="color: #0000DD; font-weight: bold">64</span>).toString(<span style="background-color: #fff0f0">&#39;base64&#39;</span>);
    } <span style="color: #008800; font-weight: bold">else</span> {
        <span style="color: #008800; font-weight: bold">return</span> password;
    }
};

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Create instance method for authenticating user</span>
<span style="color: #888888"> */</span>
UserSchema.methods.authenticate <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(password) {
    <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">this</span>.password <span style="color: #333333">===</span> <span style="color: #008800; font-weight: bold">this</span>.hashPassword(password);
};


<span style="color: #008800; font-weight: bold">var</span> User <span style="color: #333333">=</span> mongoose.model(<span style="background-color: #fff0f0">&#39;User&#39;</span>, UserSchema);
module.exports <span style="color: #333333">=</span> User;
</pre></td></tr></table></div>

<p class="l-sub-section">The backend API routes are written in the <span class="codeInsidePgrph">server.routes.js</span> file. Depending on the API route being called the respective function will be executed.</p>
<div class="example-title">users.server.routes.js</div>
<!-- HTML generated using hilite.me --><div class = "common-margin-bottom" style="background: #ffffff;background-color: #f5f5f5; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">var</span> passport <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;passport&#39;</span>);

module.exports <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(app) {
	<span style="color: #888888">// User Routes</span>
	<span style="color: #008800; font-weight: bold">var</span> users <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;./../controllers/users.server.controller&#39;</span>);

	<span style="color: #888888">// Setting up the users profile api</span>
	app.route(<span style="background-color: #fff0f0">&#39;/users/me&#39;</span>).get(users.me);
	app.route(<span style="background-color: #fff0f0">&#39;/users/:userId&#39;</span>).get(users.read);
	app.route(<span style="background-color: #fff0f0">&#39;/users/:userId&#39;</span>).put(users.update);
	app.route(<span style="background-color: #fff0f0">&#39;/users/accounts&#39;</span>).<span style="color: #008800; font-weight: bold">delete</span>(users.removeOAuthProvider);

	<span style="color: #888888">// Setting up the users password api</span>
	app.route(<span style="background-color: #fff0f0">&#39;/users/password&#39;</span>).post(users.changePassword);
	app.route(<span style="background-color: #fff0f0">&#39;/auth/forgot&#39;</span>).post(users.forgot);
	app.route(<span style="background-color: #fff0f0">&#39;/auth/reset/:token&#39;</span>).get(users.validateResetToken);
	app.route(<span style="background-color: #fff0f0">&#39;/auth/reset/:token&#39;</span>).post(users.reset);

	<span style="color: #888888">// Setting up the users authentication api</span>
	app.route(<span style="background-color: #fff0f0">&#39;/auth/signup&#39;</span>).post(users.signup);
	app.route(<span style="background-color: #fff0f0">&#39;/auth/signin&#39;</span>).post(users.signin);
	app.route(<span style="background-color: #fff0f0">&#39;/auth/signout&#39;</span>).get(users.signout);

	app.param(<span style="background-color: #fff0f0">&#39;userId&#39;</span>, users.userByID);
};
</pre></td></tr></table></div>

<p>The route <span class="codeInsidePgrph">'/auth/signup'</span> signs up a user and then signs the user in.</p>

<p>The route <span class="codeInsidePgrph">'/auth/signin'</span> signs in a user.</p>

<p>The route <span class="codeInsidePgrph">'/auth/signout'</span> signs out a user.</p>


<p><span class="codeInsidePgrph">app.param</span> gets a single user from the database if the url param contains an <b>id</b> parameter.</p>


<p class="l-sub-section">All the user related controllers are
  'require' in the <span class="codeInsidePgrph">users.server.controller.js</span> file in the controllers folder.<span class="codeInsidePgrph">users.server.controller.js</span> gives access to all the functions that the <span class="codeInsidePgrph">server.routes.js</span> uses such as signin, signout, etc.</p>

<!-- HTML generated using hilite.me --><div style="background: #ffffff;background-color: #f5f5f5; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">var</span> _ <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;lodash&#39;</span>);

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Extend user&#39;s controller</span>
<span style="color: #888888"> */</span>
module.exports <span style="color: #333333">=</span> _.extend(
	require(<span style="background-color: #fff0f0">&#39;./users/users.authentication.server.controller&#39;</span>),
	require(<span style="background-color: #fff0f0">&#39;./users/users.authorization.server.controller&#39;</span>),
	require(<span style="background-color: #fff0f0">&#39;./users/users.password.server.controller&#39;</span>),
	require(<span style="background-color: #fff0f0">&#39;./users/users.profile.server.controller&#39;</span>)
);
</pre></td></tr></table></div>

<p class="l-sub-section">The user folder inside the controllers folder contain all the files mentioned above in the code snippet. Using the functions in
  <span class="codeInsidePgrph">users.authentication.server.controller</span> we signin, signout and signup.</p>
<div class="example-title">users.authentication.server.controller</div>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;background-color: #f5f5f5;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="background-color: #fff0f0">&#39;use strict&#39;</span>;

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Module dependencies.</span>
<span style="color: #888888"> */</span>
<span style="color: #008800; font-weight: bold">var</span> _ <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;lodash&#39;</span>),
	errorHandler <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;../errors.server.controller&#39;</span>),
	mongoose <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;mongoose&#39;</span>),
	passport <span style="color: #333333">=</span> require(<span style="background-color: #fff0f0">&#39;passport&#39;</span>),
	User <span style="color: #333333">=</span> mongoose.model(<span style="background-color: #fff0f0">&#39;User&#39;</span>);

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Signup</span>
<span style="color: #888888"> */</span>
exports.signup <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
	<span style="color: #888888">// For security measurement we remove the roles from the req.body object</span>
	<span style="color: #008800; font-weight: bold">delete</span> req.body.roles;

	<span style="color: #888888">// Init Variables</span>
	<span style="color: #008800; font-weight: bold">var</span> user <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> User(req.body);
	<span style="color: #008800; font-weight: bold">var</span> message <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span>;

	<span style="color: #888888">// Add missing user fields</span>
	user.provider <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;local&#39;</span>;

	<span style="color: #888888">// Then save the user</span>
	user.save(<span style="color: #008800; font-weight: bold">function</span>(err) {
		<span style="color: #008800; font-weight: bold">if</span> (err) {
			<span style="color: #008800; font-weight: bold">return</span> res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send({
				message<span style="color: #333333">:</span> errorHandler.getErrorMessage(err)
			});
		} <span style="color: #008800; font-weight: bold">else</span> {
			<span style="color: #888888">// Remove sensitive data before login</span>
			user.password <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">undefined</span>;
			user.salt <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">undefined</span>;

			req.login(user, <span style="color: #008800; font-weight: bold">function</span>(err) {
				<span style="color: #008800; font-weight: bold">if</span> (err) {
					res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send(err);
				} <span style="color: #008800; font-weight: bold">else</span> {
					res.json(user);
				}
			});
		}
	});
};

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Signin after passport authentication</span>
<span style="color: #888888"> */</span>
exports.signin <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res, next) {

	passport.authenticate(<span style="background-color: #fff0f0">&#39;local&#39;</span>, <span style="color: #008800; font-weight: bold">function</span>(err, user, info) {
		<span style="color: #008800; font-weight: bold">if</span> (err <span style="color: #333333">||</span> <span style="color: #333333">!</span>user) {
			res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send(info);
		} <span style="color: #008800; font-weight: bold">else</span> {
			<span style="color: #888888">// Remove sensitive data before login</span>
			user.password <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">undefined</span>;
			user.salt <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">undefined</span>;

			req.login(user, <span style="color: #008800; font-weight: bold">function</span>(err) {
				<span style="color: #008800; font-weight: bold">if</span> (err) {
					res.status(<span style="color: #0000DD; font-weight: bold">400</span>).send(err);
				} <span style="color: #008800; font-weight: bold">else</span> {
					res.json(user);
				}
			});
		}
	})(req, res, next);
};

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Signout</span>
<span style="color: #888888"> */</span>
exports.signout <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">function</span>(req, res) {
	req.logout(<span style="color: #008800; font-weight: bold">function</span>(){
		<span style="color: #008800; font-weight: bold">if</span>(err){
		}
	});
	res.status(<span style="color: #0000DD; font-weight: bold">200</span>).send({message<span style="color: #333333">:</span><span style="background-color: #fff0f0">&quot;signed out&quot;</span>});
};
</pre></td></tr></table></div>

</div>
                <!-- /*********************** new signup backend end **********************/ -->
<div>
<h1 id="isomorphic">Isomorphic</h1>
<hr>
<h4 style ="color: #777; text-align: center; font-size: 40px">Comming Soon</h4>
</br>
<h1 id="testCode">Test Code</h1>
<hr>
<h4 style ="color: #777; text-align: center; font-size: 40px">Comming Soon</h4>
</div>
    </div>

      </div>
      <!-- /*********************** Col 9 Div Ends) **********************/ -->
    </div>
    <!-- /.row -->
  </div>
  <!-- /.container -->
  <div class="footer">
            Licensed under MIT &copy; 2016 | <a href="http://tech-dojo.org">TechDojo

  </div>

        <!-- jQuery Version 1.11.1 -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
</body>
</html>
